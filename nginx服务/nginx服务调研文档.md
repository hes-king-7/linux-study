## nginx的由来 
1. 因为apache被设计为一个重量级的，不支持/效果差高并发会导致http请求响应速度慢的服务器。所以轻量级高并发的服务器nginx就诞生了。
2. nginx由俄罗斯工程师lgor Sysoec使用C语言开发的。
3. nginx和Apache一样都是web服务器。以统一资源描述符(URI)或者统一资源定位符(URL)作为沟通依据。通过HTTP协议提供网络服务。
## nginx的作用
1. nginx是一款轻量级httpweb服务器和代理服务器。同时也是一个IMAP、pop3、Smtp(邮件协议)代理服务器。基于模块化的结构。
2. 什么是代理：
        代理就相当于你去买货，但是你不能直接联系到厂家，这时候你身边的朋友可以直接联系到厂家。所以你就只能让你朋友帮你去联系厂家买这个货。
你就相当于一个客户端发起请求。厂家就相当于后端服务器去回应你的请求。但是你没有渠道直接把请求发给厂家，这时候就需要一个代理服务器也就是你朋友帮你把
这个请求发送给厂家。你朋友就相当于中间的这个代理服务器。
3. 什么是正向代理：代理的是客户端
        正向代理就是前端客户端非常明确要访问的后端服务器地址。通过中间渠道正向代理服务器找到后端要访问的那台服务器。
        正向代理的情况下后端服务器只清楚请求来自那个代理服务器，也不知道来自那个具体的客户端。很好的屏蔽保护了真实客户端信息。
4. 什么是反向代理：代理的是服务器
        反向代理：多个客户端给服务器发送请求，nginx服务器接收到请求后通过一定的反向代理规则分发给后端的业务服务器进行处理。此时请求的来源客户端信息是明确的，但是请求的服务器信息并不明确。
    这个时候nginx服务器扮演的就是一个反向代理角色。
        反向代理代理的是服务器，代服务器端接收请求数据。
        反向代理隐藏了服务器的信息。反向代理过程中代理服务器是透明模式的。客户端不知道自己访问的是代理服务器。
5. 什么是负载均衡：
        负载均衡相当于反向代理的其中一种模式。多个客户端向代理服务器发送请求数据后(也叫负载量)，代理服务器将负载量按照一定的规则分发到不同的服务器进行处理，就是负载均衡处理规则。
6. 负载均衡的几种算法：
    1. weigth轮询(默认，常用，具有HA功效)通过给后端服务器设置一个权重值，用于调整不同服务器上请求的分配率。权重值越大，被分配到的请求机率越大。
    2. ip_hash(常用)，每个请求按访问的ip的hash结果分配，这样每个访客固定访问一个后端服务器。也在一定程度上解决了集群部署环境下session共享的问题。
    3. fair：智能调整调度算法，动态的根据后端服务器的请求处理到响应速度的的时间进行均衡分配。但nginx默认不支持fair算法，需要安装upstream_fair模块。
    4. url_hash: 按照访问的url的hash结果分配请求。nginx默认不支持。需要按照nginx的hash包。
## nginx对比apache和lighttpd的优劣
1. Rroxy        nginx   =       apache  > lig
2. Rewriter     nginx   >       apache  > lig
3. Fcgi         lig     >       nginx   > apache
4. 热部署       nginx支持，其它两个不支持
5. 系统压力     nginx小，lig较小，apache很大
6. 稳定性       nginx   >       apache  > lig
7. 安全性       apache  >       nginx  = lig
8. 静态文件处理 nginx   >       lig     > apache
9. 反向代理     nginx   >       apache  = lig
10. nginx适合处理静态请求。apache适合处理动态请求。所以一般前端用nginx做反向代理，apache做后端处理动态请求。
##I/O多路复用
多路复用：多个描述符的I/O操作都能在一个线程内并发交替地书讯完成。这里的复用指的是复用同一个线程。
## 多路复用器   selectpollepoll 
1. 多路服务器就是把所有的传输信号集合在一起传输，互不干扰，利用率高。 
2. select多路服务器底层是数组实现的。
3. poll & epoll是链表实现的
4. 性能调优
   1. 传统拷贝方式：4次空间转换，4次复制, 2次CPU参与。浪费空间和CPU
   2. 零拷贝基础：  2次空间转换，2次复制，无CPU参与。
## nginx动静分离
1. 静态资源： 通常指不与数据库发生交互的，一种基于W3C规范的一种网页书写格式。是一种统一协议语言。如hmtl、.gif、.jpeg、.bgm、.txt、.css等
2. 动态资源： 通常指与数据库发生交互的页面，内容展示丰富。功能强大。实用性强。如.jsp、.php、.do、.asp、.cgi、.apsx等结尾的。
3. 动静分离：动态文件和静态文件的分离。动态资源拆分，将其根据静态资源的特定做缓存操作。
4. 动静分离的作用：动静分离将网站静态资源与后台应用分开部署，提高用户访问静态代码的速度，降低对后台应用访问。一般将静态资源放到nginx中，动态资源转发到tomcat服务器中。(一般通过反向代理的方式转发到tomcat服务器中。)
5. 动静分离与前后分离的区别
   1. 动静分离不会部署在同一台服务器上
   2. 前后分离基于网站架构模式。将一个项目拆分成前端web和后端接口。中间采用RPC远程调用技术实现。
## nginx的使用
1. nginx支持yum安装。rpm包安装。和源码编译安装三种方式。
2. nginx安装时一般需要安装gcc。gcc-c++。openssl(含devel),zlib(含devel)，pcre模块。依赖包默认支持yum安装，rpm -ivh安装和./configure源码安装三种方式。
3. 其中yum安装和rpm安装由系统指定默认安装目录。源码编译可由自己指定默认安装路径。故一般情况下建议源码安装。
4. yum安装nginx的默认路径
   1. nginx的配置文件/etc/nginx/nginx.conf
   2. 自定义配置文件/etc/nginx/conf.d
   3. 项目文件存放/usr/share/nginx/html/
   4. 日志文件存放/var/log/nginx
   5. 其他文件存放/etc/nginx
5. nginx默认配置文件模块
   1. events：引起模块
   2. http：http模块
   3. server：server主机模块
6. nginx从结构上分为核心模块、基础模块、第三方模块
   1. 核心模块：http模块、event模块、mail模块等
   2. 基础模块：http access模块、http fastcgi模块、httpproxy模块、http rewrite模块
   3. 第三方模块：http upstream request hash模块、notice模块、http access key模块、limit_req模块等，也可以二次开发模块。
7. nginx匹配规则：默认端口优先级大于域名。
8. nginx访问规则：nginx由内核和模块组成。内核通过查找配置文件将客户端请求映射到一个location block。location中所配置的每个指令将会启动不同的模块去完成相应的工作。默认nginx.conf配置文件中至少存在一个location
9. nginx rewrite规则
10. nginx 结尾标识符
11. last、break/浏览器URL地址不变。
12. redirect、permanent/URL地址重写，前者返回302临时重定向/后者返回301永久重定向。







