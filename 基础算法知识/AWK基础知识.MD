# AWK
## awk的由来
1. awk是由Alfred Aho 、Peter Weinberger 和 Brian Kernighan这三个人创造的，awk由这个三个人的姓氏的首个字母组成。
## 什么是AWK
1. AWK是一个报告生成器，拥有强大的文本格式化的能力。awk其实是一门编程语言，支持条件判断、数组、循环等功能。所以也可以理解为一个脚本语言解释器。
2. awk常用语法： awk [options] 'Pattern{Action}' file
3. 当awk进行逐行处理的时候，会把pattern(模式)作为条件，判断将要被处理的行是否满足条件。是否能跟"模式"进行匹配，如果匹配，则处理，如果不匹配，则不进行处理。模式一般要配合关系表达式(如：==，<=)
4. grep、sed、awk被称为linux中的三剑客。
   1. grep：更适合单纯的查找或匹配文本。
   2. sed：更适合编辑匹配到的文本
   3. awk：更适合格式化文本，对文本进行较复杂格式处理。
5. awk最常用动作就是print和printf。因为awk要把格式化完成后的文本输出。
6. awk是逐行处理。默认以换行符\为标记，识别每一行。awk会按照用户指定的分隔符去分割当前行。如果没有指定，默认使用空格作为分隔符。
7. 比如：$1 表示分割完的第一个字段。$2 表示第二个，依次类推。 $0表示一整行。$NF表示当前行分割后的最后一列($0 和$NF均为内置变量) NF表示当前行被分割符切开以后，一共有几个字段。 每行的倒数第二列可以写为 $(NF-1).使用，可以一次输出多段。如$1,$2,$3...$NF.同理，也可以一次性输出多个指定的列。
## AWK两个特殊的模式
1. BEGIN和END
2. BEGIN模式指定了处理文本之前需要执行的操作：
3. END模式指定了处理完所有行之后所需要执行的操作。
4. 实例： awk 'BEGIN{print "a","b"} {print $1,$2} END{print "c","d"}' test 
### awk分隔符
1. awk默认分隔符是空格，除此awk还有"输入分隔符"和"输出分隔符"。
2. 输入分隔符：field separator，简称FS 默认空格。
3. 输出分隔符：output field separator 简称 OFS 默认空格。 当我们要对处理完的文本进行输出的时候，以什么文本或符号作为分隔符。 
4. 可以同时使用FS和OFS指定输入分隔符和输出分隔符。如：awk -v FS='#' -v OFS='---' '{print $1,$2}' test
5. awk ‘{print $1 $2}’ 表示每行分割后，将第一列（第一个字段）和第二列（第二个字段）连接在一起输出。
6. awk ‘{print $1,$2}’ 表示每行分割后，将第一列（第一个字段）和第二列（第二个字段）以输出分隔符隔开后显示.
### awk常用参数
1. -F 指定输入分隔符 如 -F#。指定分隔符为#。
2. -v 指定对应的变量 如 -v FS='#' 或-v OFS="+++"
### 什么是变量
1. 变量分为'内置变量'(awk预定义好的内部变量)和'自定义变量'(用户自定义的变量)
2. 常用内置变量
   1. FS：输入字段分隔符
   2. OFS：输出字段分隔符
   3. RS：输入记录分隔符(指定输入时的换行符)
   4. ORS：输出记录分隔符(指定输出时的换行符)
   5. NF：当前行的字段数量
   6. NR：当前处理的文本行的行号
   7. FNR：各文件分别计数的行号
   8. FILENAME: 当前文件名
   9. ARGC: 命令行参数的个数
   10. ARGV: 数组，保存的是命令行所给定的各参数。
3.  自定义变量的方法有
    1.  -v varname=value 变量名区分字符大小写
    2.  在grogram中直接定义。 变量定义与动作之间需要用分号；隔开。
### printf命令
1. printf命令模仿了C语言中printf()函数。printf命令的作用是按照我们指定的格式输出文本。
2. printf动作与printf命令一样，都不会输出换行符。默认会将文本输出在一行里面。
3. printf指定的格式“文本1”“文本2”“文本3”
### 常用的格式替换符：     一般结合转义符\n使用。
1. %s:代替每一个传入的参数
2. %f：将每一个传入的参数转换成"浮点类型"
3. %b 相对应的参数中包含转义字符时，可以使用此替换符进行替换，对应的转义字符会被转义。
4. %c ASCII字符。显示相对应参数的第一个字符
5. %d, %i 十进制整数
6. %o 不带正负号的八进制值
7. %u 不带正负号的十进制值
8. %x 不带正负号的十六进制值，使用a至f表示10至15
9. %X 不带正负号的十六进制值，使用A至F表示10至15
10. %% 表示”%”本身
### 常用的转义字符
1. \a 警告字符，通常为ASCII的BEL字符
2. \b 后退
3. \c 抑制（不显示）输出结果中任何结尾的换行字符（只在%b格式指示符控制下的参数字符串中有效），而且，任何留在参数里的字符、任何接下来的参数以及任何留在格式字符串中的字符，都被忽略
4. \f 换页（formfeed）
5. \n 换行
6. \r 回车（Carriage return）
7. \t 水平制表符
8. \v 垂直制表符
9. \\ 一个字面上的反斜杠字符，即”\”本身。
10. \ddd 表示1到3位数八进制值的字符，仅在格式字符串中有效
11. \0ddd 表示1到3位的八进制值字符
### 常用修饰符
1. 数字
2. +
3. -
### 在awk中使用printf注意事项
1. 使用printf动作输出的文本不会换行，如果需要换行，可以在对应的”格式替换符”后加入”\n”进行转义。
2. 使用printf动作时，”指定的格式” 与 “被格式化的文本” 之间，需要用”逗号”隔开。
3. 使用printf动作时，”格式”中的”格式替换符”必须与 “被格式化的文本” 一一对应。
### 常用模式
1. 空模式
2. 关系运算模式
3. BEGIN/END模式
4. 正则模式：把正则表达式当作条件，能与正则匹配的行。当在awk命令中使用正则模式时，属于"扩展正则表达式".当使用{x,y}这种次数匹配的正则表达式时，需要配合-posix或者-re-interval选项。如：awk '/正则表达式/{动作}'/file
5. 行范围模式：如： awk '/正则1/，/正则2/{动作}' /file  表示正则1开始到正则2结束，之间所有行都会执行对应的动作。对应的是一个范围内的所有行。
### 常用语句
1. 输出语句
2. 组合语句
3. 控制语句
### 数组(或者称索引)
awk的数组默认是一个使用字符串作为下标的关联数组。
1. 数组的下标通常由0开始"[0]"。但是在awk中，数组元素的下标默认从1开始。awk中数组的下标也可以为任意字符串。
2. 当一个元素不存在数组时，直接引用awk会自动创建这个元素，并默认为其赋值为"空字符串"
3. awk中，可以使用if(下标 in 数组名)，从而判断数组中是否存在对应的元素。
4. 使用delete可以删除数组中的元素，也可以删除整个数组。
5. 在for循环中的变量i表示的是元素的下标，而非元素的值。如果想要输出元素的值，则需要使用"print 数组名[变量]"
6. awk中，我们是通过下标的顺序，输出对应元素值的顺序。也叫键值定位。
7. 在awk中，如果字符串参与运算，(空)字符串将被当作数字0进行运算。
8. 我们对一个不存在的元素进行自加运算后，这个元素的值就变成了自加运算的次数。
### awk函数
在awk中，可以自定义函数，也有内置函数
内置函数： 算数函数、字符串函数、时间函数、其他函数等。
1. **算数函数**：最常用的有rand函数、srand函数、int函数。
2. 使用rand函数生成随机数，需要配合srand函数。否则返回值将不变。使用int函数可以截取整数部分的值。
3. **字符串函数**：
   1. gsub函数会在指定范围内查找指定的字符。并将其替换为指定的字符串(相当于指定范围内的全局替换)。
   2. sub函数只会替换指定范围内第一次匹配到的符合条件的字符(指定范围内的单次替换)。
   3. length函数：获取到指定字符串的长度。index函数：可以获取到指定字符位于整个字符串中的位置。
   4. split函数：可以将指定的字符串按照指定的分割符切割。将切割后的每一段赋值到数组的元素中，从而动态的创建数组。被split函数分割后的数组的元素下标从1开始。(其它默认从0开始)。
4. **其它函数**：
   1. asort函数：根据元素的值进行排序。但是数组下标将会被重置。asort的返回值就是数组的长度(数组中元素的数量)。
   2. asorti函数：可以根据元素的下标进行排序。当元素下标为字符串时，可以使用asorti函数，根据下标的字母顺序进行排序。并且将排序后的下标放置到一个新的数组中。并返回新的数组的长度。当元素下标为数字时，可以直接使用for循环即可排序。
### 三元运算
1. 三元运算可以代替if else语法。
2. 三元运算语法1： 条件？ 结果1：结果2(如果条件成立，则返回结果1，如果条件不成立，则返回结果2)
3. 语法2：表达式1？ 表达式2：表达式3 （如果表达式1为真，则执行表达式2，如果表达式1为假，则执行表达式3）
### 打印奇偶行
1. 在awk中，如果省略了模式对应的动作，当前行满足模式时，默认动作为打印整行，即{print $0}
2. 在awk中，0或者空字符串表示"假"。非0值或者非空字符串表示"真"